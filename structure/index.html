<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="BioFolD - Structure">
    <meta name="author" content="BioFolD - Emidio Capriotti">
    <link rel="icon" href="/favicon.ico">

    <title>BioFolD - Structure</title>
    <link rel="stylesheet" href="maps/style.css" type="text/css" />
    <link rel="stylesheet" href="maps/mapstyle.css" type="text/css" />

    <!-- Bootstrap core CSS -->
    <link href="../pages/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug 
    <link href="pages/assets/css/ie10-viewport-bug-workaround.css" rel="stylesheet">
    -->

    <!-- Custom styles for this template -->
    <link href="../pages/style/jumbotron-narrow-biofold.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]
    <script src="pages/assets/js/ie-emulation-modes-warning.js"></script>
    -->

<script>
const eventListenerOptionsSupported = () => {
  let supported = false;

  try {
    const opts = Object.defineProperty({}, 'passive', {
      get() {
        supported = true;
      }
    });

    window.addEventListener('test', null, opts);
    window.removeEventListener('test', null, opts);
  } catch (e) {}

  return supported;
}

const defaultOptions = {
  passive: false,
  capture: false
};
const supportedPassiveTypes = [
  'scroll', 'wheel',
  'touchstart', 'touchmove', 'touchenter', 'touchend', 'touchleave',
  'mouseout', 'mouseleave', 'mouseup', 'mousedown', 'mousemove', 'mouseenter', 'mousewheel', 'mouseover'
];
const getDefaultPassiveOption = (passive, eventName) => {
  if (passive !== undefined) return passive;

  return supportedPassiveTypes.indexOf(eventName) === -1 ? false : defaultOptions.passive;
};

const getWritableOptions = (options) => {
  const passiveDescriptor = Object.getOwnPropertyDescriptor(options, 'passive');

  return passiveDescriptor && passiveDescriptor.writable !== true && passiveDescriptor.set === undefined
    ? Object.assign({}, options)
    : options;
};

const overwriteAddEvent = (superMethod) => {
  EventTarget.prototype.addEventListener = function (type, listener, options) {
    const usesListenerOptions = typeof options === 'object' && options !== null;
    const useCapture          = usesListenerOptions ? options.capture : options;

    options         = usesListenerOptions ? getWritableOptions(options) : {};
    options.passive = getDefaultPassiveOption(options.passive, type);
    options.capture = useCapture === undefined ? defaultOptions.capture : useCapture;

    superMethod.call(this, type, listener, options);
  };

  EventTarget.prototype.addEventListener._original = superMethod;
};

const supportsPassive = eventListenerOptionsSupported();

if (supportsPassive) {
  const addEvent = EventTarget.prototype.addEventListener;
  overwriteAddEvent(addEvent);
}

</script>

    <link rel="stylesheet" href="maps/leaflet.css" />
	   
  </head>
  
     
<script type="text/javascript">
    var today = new Date();
    var year_now = today.getFullYear();
    var month_now = today.getMonth();
    function writeYearOptions(startYear, endYear)
    {
    var optionCounter;
    for (optionCounter = startYear; optionCounter >= endYear; optionCounter--)
    {
    document.write('<OPTION value=' + optionCounter + '>' + optionCounter);
    }
    }
    function writeMonthOptions()
    {
    var Months=["Year","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
    var vMonths=["","01","02","03","04","05","06","07","08","09","10","11","12"];
    for (optionCounter = 0; optionCounter <= 12; optionCounter++)
    {
    document.write('<OPTION value=' + vMonths[optionCounter] + '>' + Months[optionCounter]);
    }
    }
    function writeTools()
    {
    var Tools=["ALL","SARA","Structure"];
    for (optionCounter = 0; optionCounter <= 2; optionCounter++)
    {
    document.write('<OPTION value=' + Tools[optionCounter] + '>' + Tools[optionCounter]);
    }
    }
</script>

<script src="maps/leaflet.js"></script>

    <script type="text/javascript">

      var map;
      var layerGroups = [];

      function initializeMap() {
            if (map) {
                map.remove();
            }
            map = L.map('map', { attributionControl: false, zoomControl: false }).setView([0, 0], 1);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                maxZoom: 19,
            }).addTo(map);

                var customControl = L.Control.extend({
                onAdd: function() {
                    var container = L.DomUtil.create('div', 'leaflet-control leaflet-bar');

                    // Create zoom in button
                    var zoomInButton = L.DomUtil.create('a', 'leaflet-control-zoom-in', container);
                    zoomInButton.innerHTML = '+';
                    zoomInButton.href = '#';
                    zoomInButton.onclick = function(e) {
                        e.preventDefault();
                        map.zoomIn();
                    };

                    // Create reset button
                    var resetButton = L.DomUtil.create('a', 'reset-button', container);
                    resetButton.innerHTML = 'Reset';
                    resetButton.href = '#';
                    resetButton.onclick = function(e) {
                        e.preventDefault();
                        map.setView([0, 0], 1); // Reset to initial coordinates and zoom level
                    };

                    // Create zoom out button
                    var zoomOutButton = L.DomUtil.create('a', 'leaflet-control-zoom-out', container);
                    zoomOutButton.innerHTML = '-';
                    zoomOutButton.href = '#';
                    zoomOutButton.onclick = function(e) {
                        e.preventDefault();
                        map.zoomOut();
                    };

                    return container;
                },
                onRemove: function(map) {
                    // Nothing to do here
                }
            });

            // Add the custom control to the map
            map.addControl(new customControl({ position: 'topleft' }));
        }


      function clearLayerGroups() {
            layerGroups.forEach(layerGroup => {
                layerGroup.clearLayers();
                map.removeLayer(layerGroup);
            });
            layerGroups = [];
        }


      // Function to load coordinates from a JSON file and add them to the specified layer group with the specified icon
              function loadCoordinates(file, layerGroup, icon) {
                 fetch(file)
                .then(response => response.text())
                .then(data => {
                    var parser = new DOMParser();
                    var xmlDoc = parser.parseFromString(data, "application/xml");
                    var locations = xmlDoc.getElementsByTagName('item');
                    for (var i = 0; i < locations.length; i++) {
                        var lat = parseFloat(locations[i].getElementsByTagName('geo:lat')[0].textContent);
                        var lng = parseFloat(locations[i].getElementsByTagName('geo:long')[0].textContent);
                        var name = locations[i].getElementsByTagName('description')[0].textContent;

                        // Add a marker for each location with the custom icon
                        L.marker([lat, lng], { icon: icon })
                            .addTo(layerGroup)
                            .bindPopup(name);
                    }
                })
                .catch(error => console.error('Error loading coordinates:', error));
        }


    function CheckDate(month,year)
		{
		var dmonth = {"": 0, "01": 1,"02": 2,"03": 3,"04": 4,"05": 5,"06": 6,"07": 7,"08":8,"09": 9,"10": 10,"11": 11,"12": 12 };
		var today = new Date();
        var this_year = today.getFullYear();
        var this_month = today.getMonth()+1;
        var long_today = this_year*100+this_month;
        var long_date = year*100+dmonth[month];
        /* Server up since Oct2010 = 201010 */
		if ( (long_date>=201010 || long_date==201000 ) && long_date<=long_today )
		{
			return true;
		}
		else
		{
			return false;
		}
		}


    function addServer(map,layerGroups,name,month,year,mcolor)
        {
        var htool = {"structure": "Structure@BioFolD", "sara": "SARA" };
        if (htool[name] === undefined )
        {
        	var geoname="Other";
        }
        else
        {
        	var geoname=htool[name];
        }

        var marlayer = L.icon({
                  iconUrl: "maps/img/"+mcolor+"-ball.png", // Path to your second custom marker icon
                  iconSize: [9, 9] // Size of the icon [width, height]
              });
        var filename="maps/georss/access_"+name+year+month+".xml";

        if (CheckDate(month,year) == true)
        {
             var slayer = L.layerGroup().addTo(map);
             layerGroups.push(slayer);
             loadCoordinates(filename, slayer, marlayer);
        }
        else
        {
        	var nologfile = "maps/georss/nolog.xml";
            var slayer = L.layerGroup().addTo(map);
            layerGroups.push(slayer);
            loadCoordinates(nologfile, slayer, marlayer);
        }
        return slayer;
        }


function timemap(month,year) {
        if (map) {
          clearLayerGroups();
        }
        initializeMap();


        var mbass = L.icon({
                  iconUrl: 'maps/img/bass.png', // Path to your second custom marker icon
                  iconSize: [13, 13] // Size of the icon [width, height]
              });
        var sbass = L.layerGroup().addTo(map);

        layerGroups.push(sbass);
        loadCoordinates('maps/georss/unibo.xml', sbass, mbass);
        var structure = addServer(map,layerGroups,'structure',month,year,'yellow');
        var sara = addServer(map,layerGroups,'sara',month,year,'orange');
        }


	    function get_time()
    	{
    	var i;
    	var month=document.selectlog.month.value;
    	var year=document.selectlog.year.value;
        if (map) {
          clearLayerGroups();
        }
        initializeMap();


        var mbass = L.icon({
                  iconUrl: 'maps/img/bass.png', // Path to your second custom marker icon
                  iconSize: [13, 13] // Size of the icon [width, height]
              });
        var sbass = L.layerGroup().addTo(map);

        layerGroups.push(sbass);
        loadCoordinates('maps/georss/unibo.xml', sbass, mbass);
        var structure = addServer(map,layerGroups,'structure',month,year,'yellow');
        var sara = addServer(map,layerGroups,'sara',month,year,'orange');

    	/*var pp = document.getElementById('map').innerHtml;
    	document.write(pp);*/
    	return false;
    	}

    function get_now()
    	{
    	var today = new Date();
        var year = today.getFullYear();
        var month = today.getMonth()+1;
        var lmonth=["","01","02","03","04","05","06","07","08","09","10","11","12"];
        timemap(lmonth[month],year);
    	return false;
    	}

      function show_layer(servername) {
        var ntool = {
        "Structure\@BioFolD": 1,
        "SARA": 2,
        "unibo": 0,
        };

        // Get the corresponding layer number for the server name
        var numserver = ntool[servername];

        // Check if the server name is valid
        if (numserver === undefined) {
           console.error("Invalid server name:", servername);
           return false; // Early exit if the server name is not valid
        }

        // Loop through layers to set their visibility
        layerGroups.forEach(function(layer, index) {
        // Change visibility based on the layer index (adjusted for 0-based index)
        if (index === numserver) {
            layer.addTo(map); // Add layer to map to make it visible
        } else {
            map.removeLayer(layer); // Remove layer from map to make it invisible
        }
    });

        // Optionally refresh the map (if necessary)
        // map.refresh();

        return false;
        }

      function show_alllayer() {

        // Loop through layers to set their visibility
        layerGroups.forEach(function(layer, index) {
        // Change visibility based on the layer index (adjusted for 0-based index)
          layer.addTo(map); // Add layer to map to make it visible
        });

        // Optionally refresh the map (if necessary)
        // map.refresh();
        return false;
        }

   </script>


  <body onload="get_now();">
    <br>
    <div id="main">
    <div class="container">

      <div class="jumbotron">
        <table width="100%">
        <tr>
        <td width="90%">
        <div class='biofold' ><span style="color:#c31e27;">Bio</span><span style="color:#4689a3;">molecules</span> <span style="color:#c31e27;">Fol</span><span style="color:#4689a3;">ding and </span><span style="color:#c31e27;">D</span><span style="color:#4689a3;">isease</span></div><br>
	</td>
	<td width="10%">
	<div class="right_cell">
        <a href="http://biofold.org">
        <img src="../pages/img/logo.png" width="75px" align="left">
        </a>
        </div>
	</td>
	</tr>
	</table>

	<table width="100%">
        <tr>
        <td>
        <div class="form-inline justify-content-center">
        <nav>
          <ul class="nav nav-pills">
            <li role="presentation" ><a href="../index.html">Home</a></li>
            <li role="presentation"><a href="../research.html">Research</a></li>
            <li role="presentation" ><a href="../people.html">People</a></li>
            <li role="presentation" class='active'><a href="../resources.html">Resources</a></li>
            <li role="presentation"><a href="../papers.html">Publications</a></li>
            <li role="presentation"><a href="../training.html">Training</a></li>
          </ul>
        </nav>
        </div>
        </td>
        </tr>
        </table>
    <br>
  	<br>
  	

     <div class="text">
     <h4 class="title" >Structure - BioFolD</h4>
     </div>
     <p class="text">
	
   <br />
   In this page are reported information about the projects related to the 
   the study of macromolecular structures .
   Currently we have one web tools located in our server and other two
   developed tools hosted in other servers:
   <br /><br />
   <div class="text"> 
     <table class="paper">
     <tbody>
     <tr>
       <td valign="top" width=130><a target="blank" 
     href="http://structure.biofold.org/sara/"><b>SARA</b></a></td>
       <td valign="top">Method for RNA structure alignment and RNA functional assignment. <br />
         <a target="blank" href="http://www.ncbi.nlm.nih.gov/pubmed/19483098"> <img src="../pages/img/pubmed.gif" /></a> 
         <a href="../pages/documents/papers/CapriottiNAR09.pdf"> <img width="14"  src="../pages/img/pdf.gif" /></a></td>
     </tr>     
          <tr>
     <td valign="top" width=130><a target="blank"
     href="http://www.tcoffee.org/Projects/saracoffee/"><b>SARA-Coffee</b></a></td>
     <td valign="top">Method for RNA multiple structure alignment  <br />
     <a target="blank" href="http://www.ncbi.nlm.nih.gov/pubmed/23449094"><img src="../pages/img/pubmed.gif" /></a> 
     <a href="../pages/documents/papers/Kemena_Bioinformatics2013.pdf"><img width="14"  src="../pages/img/pdf.gif" /></a></td>
     </tr>
     <tr>
          <td valign="top" width=130><a target="blank"
               href="http://melolab.org/webrasp"><b>WebRASP</b></a></td>
          <td valign="top">Method for the assessment RNA 3D structures  <br />
     <a target="blank" href="http://www.ncbi.nlm.nih.gov/pubmed/23929030"><img src="../pages/img/pubmed.gif" /></a> 
     <a href="../pages/documents/papers/Norambuena_Bioinformatics2013.pdf"><img width="14"  src="../pages/img/pdf.gif" /></a></td> 
     </tr>        
     </tbody></table>
     </div>
     <br>
     <p class="text">
     The implementation of these web servers has been made possible
     with funds from the Marie Curie International Reintegration Grant (IRG39722) 
     delivered to Marc Marti-Renom. 
     <br>
     Since September 2012, the log file of this server is monitored periodically 
     and the tools' usage is mapped below. Better statistics about the usage of these resources are available 
     on this <a href="http://biofold.org/awstats/awstats.pl?config=structure.biofold.org" target=_blank>web page</a>.
     <br /><br /> 
     <form name="selectlog" method=post  align=center >
     </select>
     <select name="month">
     <script>
     writeMonthOptions();
     </script>
     </select>
     <select name="year">
     <script>
     writeYearOptions(year_now,2012);
     </script>
     </select>
     <input type="button" value="OK" onclick="get_time();"/>
     <br>
     <br>
     </form>
     <div id="map" class="mediummap" > </div>
     <br>
     <div id="maplegend"> 
     <a style="cursor: pointer;" onclick='show_alllayer();' ><strong>Servers</strong></a>: &nbsp;
     <img src="maps/img/bass.png" width="13" height="13" > 
     <a style="cursor: pointer;" onclick='show_layer("unibo");' >unibo</a> &nbsp; 
     <img src="maps/img/yellow-ball.png" width="11" height="11"> 
     <a style="cursor: pointer;" onclick='show_layer("Structure\@BioFolD");' >Structure@BioFolD</a> &nbsp;
     <img src="maps/img/orange-ball.png" width="11" height="11"  > 
     <a style="cursor: pointer;" onclick='show_layer("SARA");' >SARA</a> &nbsp;
     </div>

     
     </p>    <br>
    <br>
    <div class='footer-ok'><div>

      </div>
    </div> <!-- /container -->


    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug
    <script src="pages/assets/js/ie10-viewport-bug-workaround.js"></script>
    -->
  </body>
</html>
